path : /home/shiyan/project/text_generation
tokenizer loadding...
  0%|                                                                                                                                                  | 0/830 [00:00<?, ?it/s]  0%|▏                                                                                                                                         | 1/830 [00:03<50:54,  3.68s/it]  0%|▎                                                                                                                                         | 2/830 [00:07<51:34,  3.74s/it]  0%|▍                                                                                                                                         | 3/830 [00:11<52:00,  3.77s/it]  0%|▋                                                                                                                                         | 4/830 [00:15<53:20,  3.87s/it]  1%|▊                                                                                                                                         | 5/830 [00:18<51:29,  3.74s/it]  1%|▉                                                                                                                                         | 6/830 [00:22<49:47,  3.63s/it]  1%|█▏                                                                                                                                        | 7/830 [00:26<50:20,  3.67s/it]  1%|█▎                                                                                                                                        | 8/830 [00:30<53:05,  3.87s/it]  1%|█▍                                                                                                                                        | 9/830 [00:34<52:09,  3.81s/it]  1%|█▋                                                                                                                                       | 10/830 [00:37<51:26,  3.76s/it]  1%|█▊                                                                                                                                       | 11/830 [00:41<50:47,  3.72s/it]  1%|█▉                                                                                                                                       | 12/830 [00:44<49:36,  3.64s/it]  2%|██▏                                                                                                                                      | 13/830 [00:48<50:46,  3.73s/it]  2%|██▎                                                                                                                                      | 14/830 [00:53<52:57,  3.89s/it]  2%|██▍                                                                                                                                      | 15/830 [00:56<53:01,  3.90s/it]  2%|██▋                                                                                                                                      | 16/830 [01:01<55:01,  4.06s/it]  2%|██▊                                                                                                                                    | 17/830 [01:07<1:01:53,  4.57s/it]  2%|██▉                                                                                                                                      | 18/830 [01:10<58:56,  4.36s/it]  2%|███▏                                                                                                                                     | 19/830 [01:14<56:37,  4.19s/it]  2%|███▎                                                                                                                                     | 20/830 [01:18<56:15,  4.17s/it]  3%|███▍                                                                                                                                     | 21/830 [01:22<54:41,  4.06s/it]  3%|███▋                                                                                                                                     | 22/830 [01:26<52:52,  3.93s/it]  3%|███▊                                                                                                                                     | 23/830 [01:30<51:48,  3.85s/it]  3%|███▉                                                                                                                                     | 24/830 [01:33<50:16,  3.74s/it]  3%|████▏                                                                                                                                    | 25/830 [01:37<51:28,  3.84s/it]  3%|████▎                                                                                                                                    | 26/830 [01:41<51:46,  3.86s/it]  3%|████▍                                                                                                                                    | 27/830 [01:45<51:42,  3.86s/it]  3%|████▌                                                                                                                                    | 28/830 [01:49<51:52,  3.88s/it]  3%|████▊                                                                                                                                    | 29/830 [01:52<50:14,  3.76s/it]  4%|████▉                                                                                                                                    | 30/830 [01:56<50:04,  3.76s/it]  4%|█████                                                                                                                                    | 31/830 [02:01<54:19,  4.08s/it]  4%|█████▎                                                                                                                                   | 32/830 [02:05<52:53,  3.98s/it]  4%|█████▍                                                                                                                                   | 33/830 [02:09<53:27,  4.02s/it]  4%|█████▌                                                                                                                                   | 34/830 [02:12<51:09,  3.86s/it]  4%|█████▊                                                                                                                                   | 35/830 [02:16<49:32,  3.74s/it]  4%|█████▉                                                                                                                                   | 36/830 [02:19<47:54,  3.62s/it]  4%|██████                                                                                                                                   | 37/830 [02:22<47:02,  3.56s/it]  5%|██████▎                                                                                                                                  | 38/830 [02:27<50:28,  3.82s/it]  5%|██████▍                                                                                                                                  | 39/830 [02:31<50:12,  3.81s/it]  5%|██████▌                                                                                                                                  | 40/830 [02:34<49:33,  3.76s/it]  5%|██████▊                                                                                                                                  | 41/830 [02:37<47:24,  3.60s/it]  5%|██████▉                                                                                                                                  | 42/830 [02:41<46:22,  3.53s/it]  5%|███████                                                                                                                                  | 43/830 [02:45<48:32,  3.70s/it]  5%|███████▎                                                                                                                                 | 44/830 [02:48<47:40,  3.64s/it]  5%|███████▍                                                                                                                                 | 45/830 [02:52<47:53,  3.66s/it]  6%|███████▌                                                                                                                                 | 46/830 [02:56<47:51,  3.66s/it]  6%|███████▊                                                                                                                                 | 47/830 [02:59<47:25,  3.63s/it]  6%|███████▉                                                                                                                                 | 48/830 [03:04<49:37,  3.81s/it]  6%|████████                                                                                                                                 | 49/830 [03:07<48:39,  3.74s/it]  6%|████████▎                                                                                                                                | 50/830 [03:12<54:12,  4.17s/it]  6%|████████▍                                                                                                                                | 51/830 [03:16<53:04,  4.09s/it]  6%|████████▌                                                                                                                                | 52/830 [03:21<53:58,  4.16s/it]  6%|████████▋                                                                                                                                | 53/830 [03:24<51:32,  3.98s/it]  7%|████████▉                                                                                                                                | 54/830 [03:28<50:32,  3.91s/it]  7%|█████████                                                                                                                                | 55/830 [03:32<50:23,  3.90s/it]  7%|█████████▏                                                                                                                               | 56/830 [03:36<51:04,  3.96s/it]  7%|█████████▍                                                                                                                               | 57/830 [03:40<51:02,  3.96s/it]  7%|█████████▌                                                                                                                               | 58/830 [03:46<57:45,  4.49s/it]  7%|█████████▋                                                                                                                               | 59/830 [03:50<59:24,  4.62s/it]  7%|█████████▉                                                                                                                               | 60/830 [03:55<57:07,  4.45s/it]  7%|██████████                                                                                                                               | 61/830 [03:58<54:43,  4.27s/it]  7%|██████████▏                                                                                                                              | 62/830 [04:02<53:30,  4.18s/it]  8%|██████████▍                                                                                                                              | 63/830 [04:06<50:48,  3.97s/it]  8%|██████████▌                                                                                                                              | 64/830 [04:10<49:40,  3.89s/it]  8%|██████████▋                                                                                                                              | 65/830 [04:13<48:10,  3.78s/it]  8%|██████████▉                                                                                                                              | 66/830 [04:17<47:47,  3.75s/it]  8%|███████████                                                                                                                              | 67/830 [04:21<49:02,  3.86s/it]  8%|███████████▏                                                                                                                             | 68/830 [04:25<51:42,  4.07s/it]  8%|███████████▍                                                                                                                             | 69/830 [04:29<49:33,  3.91s/it]  8%|███████████▌                                                                                                                             | 70/830 [04:32<47:11,  3.73s/it]  9%|███████████▋                                                                                                                             | 71/830 [04:36<46:16,  3.66s/it]  9%|███████████▉                                                                                                                             | 72/830 [04:40<47:06,  3.73s/it]  9%|████████████                                                                                                                             | 73/830 [04:44<47:32,  3.77s/it]  9%|████████████▏                                                                                                                            | 74/830 [04:47<47:50,  3.80s/it]  9%|████████████▍                                                                                                                            | 75/830 [04:51<48:12,  3.83s/it]  9%|████████████▌                                                                                                                            | 76/830 [04:55<47:44,  3.80s/it]  9%|████████████▋                                                                                                                            | 77/830 [04:59<48:20,  3.85s/it]  9%|████████████▊                                                                                                                            | 78/830 [05:03<47:20,  3.78s/it] 10%|█████████████                                                                                                                            | 79/830 [05:07<47:58,  3.83s/it] 10%|█████████████▏                                                                                                                           | 80/830 [05:11<48:33,  3.89s/it] 10%|█████████████▎                                                                                                                           | 81/830 [05:15<49:07,  3.94s/it] 10%|█████████████▌                                                                                                                           | 82/830 [05:18<48:10,  3.86s/it] 10%|█████████████▋                                                                                                                           | 83/830 [05:22<48:26,  3.89s/it]Traceback (most recent call last):
  File "./text_keywords_generation/train.py", line 311, in <module>
    train_val(model, tokenizer, trainset, valset, args)
  File "./text_keywords_generation/train.py", line 172, in train_val
    trainer.train()
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1178, in train
    self._maybe_log_save_evaluate(tr_loss, model, trial, epoch)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1265, in _maybe_log_save_evaluate
    metrics = self.evaluate()
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1757, in evaluate
    output = self.prediction_loop(
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1895, in prediction_loop
    loss, logits, labels = self.prediction_step(model, inputs, prediction_loss_only, ignore_keys=ignore_keys)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/trainer.py", line 2031, in prediction_step
    loss, outputs = self.compute_loss(model, inputs, return_outputs=True)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/trainer.py", line 1556, in compute_loss
    outputs = model(**inputs)
  File "/home/shiyan/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 904, in forward
    transformer_outputs = self.transformer(
  File "/home/shiyan/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 752, in forward
    outputs = block(
  File "/home/shiyan/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 290, in forward
    attn_outputs = self.attn(
  File "/home/shiyan/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 241, in forward
    attn_outputs = self._attn(query, key, value, attention_mask, head_mask, output_attentions)
  File "/home/shiyan/.local/lib/python3.8/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 168, in _attn
    w = torch.matmul(q, k)
RuntimeError: CUDA out of memory. Tried to allocate 15.61 GiB (GPU 0; 15.78 GiB total capacity; 8.36 GiB already allocated; 5.88 GiB free; 8.68 GiB reserved in total by PyTorch)
 10%|█████████████▋                                                                                                                           | 83/830 [05:41<51:15,  4.12s/it]
